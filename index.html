<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Customer Requests</title>

    <style>
        * {
            box-sizing: border-box;
            margin: 0;
            padding: 0;
        }

        body {
            font-family: "Segoe UI", Inter, system-ui, -apple-system, sans-serif;
            background: linear-gradient(135deg, #f5f7fa, #e4e9f0);
            padding: 40px 20px;
            color: #333;
        }

        .container {
            background: #ffffff;
            max-width: 520px;
            margin: auto;
            padding: 28px 30px;
            border-radius: 14px;
            box-shadow: 0 12px 35px rgba(0, 0, 0, 0.08);
        }

        h2 {
            text-align: center;
            margin-bottom: 22px;
            font-weight: 600;
            color: #222;
        }

        label {
            display: block;
            margin-top: 18px;
            font-size: 13px;
            font-weight: 500;
            color: #555;
        }

        input,
        textarea {
            width: 100%;
            margin-top: 6px;
            padding: 12px 14px;
            font-size: 14px;
            border-radius: 10px;
            border: 1px solid #d6dbe1;
            background: #fafafa;
            transition: all 0.25s ease;
        }

            input:focus,
            textarea:focus {
                outline: none;
                border-color: #4f7cff;
                background: #ffffff;
                box-shadow: 0 0 0 3px rgba(79, 124, 255, 0.15);
            }

        button {
            margin-top: 22px;
            padding: 12px;
            font-size: 14px;
            font-weight: 500;
            border-radius: 12px;
            border: none;
            cursor: pointer;
            background: linear-gradient(135deg, #4f7cff, #3a63f3);
            color: #fff;
            transition: all 0.25s ease;
        }

            button:hover {
                transform: translateY(-1px);
                box-shadow: 0 8px 20px rgba(79, 124, 255, 0.35);
            }

        /* ---------- Admin Panel ---------- */
        .admin {
            position: fixed;
            bottom: 16px;
            right: 16px;
            width: 260px;
            background: rgba(30, 30, 30, 0.95);
            color: #fff;
            padding: 14px 16px;
            border-radius: 14px;
            font-size: 12.5px;
            box-shadow: 0 10px 25px rgba(0, 0, 0, 0.35);
        }

            .admin strong {
                display: block;
                margin-bottom: 8px;
            }

            .admin input {
                width: 100%;
                margin-top: 6px;
                padding: 8px 10px;
                font-size: 12px;
                border-radius: 8px;
                border: none;
            }

            .admin button {
                margin-top: 8px;
                padding: 8px;
                font-size: 12px;
                border-radius: 8px;
                background: linear-gradient(135deg, #ff7a7a, #e04b4b);
            }

        #result {
            margin-top: 10px;
            padding: 8px;
            background: rgba(255, 255, 255, 0.1);
            border-radius: 8px;
            line-height: 1.4;
        }

        .close-btn {
            cursor: pointer;
            color: #ff5c5c;
            font-size: 16px;
            font-weight: bold;
        }

            .close-btn:hover {
                color: #ff2b2b;
            }

        .hidden {
            display: none;
        }
    </style>
</head>
<body>

    <div class="container">
        <h2>Customer Request Form</h2>

        <label>First and Last Name</label>
        <input type="text" id="fullName" required>

        <label>Email or Phone Number</label>
        <input type="text" id="contact" required>

        <label>Request</label>
        <textarea id="request" rows="4" required></textarea>

        <button onclick="submitForm()">Done</button>
    </div>

    <!-- Admin Panel -->
    <div class="admin">
        <div id="lock">
            <strong>Admin Access</strong>
            <input type="password" id="passcode" placeholder="Enter passcode">
            <button onclick="unlock()">Unlock</button>
        </div>

        <div id="adminPanel" class="hidden">
            <div style="display:flex; justify-content:space-between; align-items:center;">
                <strong>Admin Panel</strong>
                <span class="close-btn" onclick="closeAdmin()">✕</span>
            </div>

            <input type="number" id="customerNo" placeholder="Customer #">
            <button onclick="viewCustomer()">View</button>
            <div id="result"></div>
        </div>
    </div>

    <script>
        function submitForm() {
            const fullName = document.getElementById("fullName").value.trim();
            const contact = document.getElementById("contact").value.trim();
            const request = document.getElementById("request").value.trim();

            if (!fullName || !contact || !request) return;

            let customers = JSON.parse(localStorage.getItem("customers")) || [];

            let lastId = parseInt(localStorage.getItem("lastCustomerId")) || 0;
            const customerNumber = lastId + 1;
            localStorage.setItem("lastCustomerId", customerNumber);

            const entry = {
                number: customerNumber,
                name: fullName,
                contact: contact,
                request: request,
                timestamp: new Date().toISOString()
            };

            customers.push(entry);
            localStorage.setItem("customers", JSON.stringify(customers));

            const safeName = fullName
                .toLowerCase()
                .replace(/[^a-z0-9]+/g, "_")
                .replace(/^_|_$/g, "");

            const fileName = `${safeName}_customer_${customerNumber}.txt`;

            const fileContent =
                `Customer #${customerNumber}
Name: ${fullName}
Contact: ${contact}

Request:
${request}

Date: ${new Date().toLocaleString()}
`;

            const blob = new Blob([fileContent], { type: "text/plain" });
            const url = URL.createObjectURL(blob);

            const a = document.createElement("a");
            a.href = url;
            a.download = fileName;
            document.body.appendChild(a);
            a.click();

            document.body.removeChild(a);
            URL.revokeObjectURL(url);

            document.getElementById("fullName").value = "";
            document.getElementById("contact").value = "";
            document.getElementById("request").value = "";
        }

        function unlock() {
            const code = document.getElementById("passcode").value;
            if (code === "1212") {
                document.getElementById("lock").classList.add("hidden");
                document.getElementById("adminPanel").classList.remove("hidden");
            }
        }

        function closeAdmin() {
            document.getElementById("adminPanel").classList.add("hidden");
            document.getElementById("lock").classList.remove("hidden");
            document.getElementById("passcode").value = "";
            document.getElementById("result").innerHTML = "";
        }

        function viewCustomer() {
            const num = parseInt(document.getElementById("customerNo").value);
            const customers = JSON.parse(localStorage.getItem("customers")) || [];
            const customer = customers.find(c => c.number === num);

            const result = document.getElementById("result");
            if (customer) {
                result.innerHTML =
                    "<strong>Customer #" + customer.number + "</strong><br>" +
                    "Name: " + customer.name + "<br>" +
                    "Contact: " + customer.contact + "<br>" +
                    "Request: " + customer.request;
            } else {
                result.innerHTML = "Customer not found.";
            }
        }
    </script>

</body>
</html>
